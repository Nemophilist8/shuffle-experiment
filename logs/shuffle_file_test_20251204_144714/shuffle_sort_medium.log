=== Dispatcher: Routing to task [file] ===
Running File Count Monitor with args: sort medium
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
25/12/04 14:49:36 INFO SparkContext: Running Spark version 1.6.3
25/12/04 14:49:36 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/04 14:49:36 WARN SparkConf: In Spark 1.0 and later spark.local.dir will be overridden by the value set by the cluster manager (via SPARK_LOCAL_DIRS in mesos/standalone and LOCAL_DIRS in YARN).
25/12/04 14:49:36 WARN Utils: Your hostname, hygon7490 resolves to a loopback address: 127.0.0.1; using 49.52.27.65 instead (on interface ens2f1np1)
25/12/04 14:49:36 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
25/12/04 14:49:36 INFO SecurityManager: Changing view acls to: djk
25/12/04 14:49:36 INFO SecurityManager: Changing modify acls to: djk
25/12/04 14:49:36 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(djk); users with modify permissions: Set(djk)
25/12/04 14:49:36 INFO Utils: Successfully started service 'sparkDriver' on port 33843.
25/12/04 14:49:37 INFO Slf4jLogger: Slf4jLogger started
25/12/04 14:49:37 INFO Remoting: Starting remoting
25/12/04 14:49:37 INFO Remoting: Remoting started; listening on addresses :[akka.tcp://sparkDriverActorSystem@49.52.27.65:35397]
25/12/04 14:49:37 INFO Utils: Successfully started service 'sparkDriverActorSystem' on port 35397.
25/12/04 14:49:37 INFO SparkEnv: Registering MapOutputTracker
25/12/04 14:49:37 INFO SparkEnv: Registering BlockManagerMaster
25/12/04 14:49:37 INFO DiskBlockManager: Created local directory at /tmp/spark/work/blockmgr-efd70a03-ff38-43c0-8fa5-a7f38bae6fba
25/12/04 14:49:37 INFO MemoryStore: MemoryStore started with capacity 143.3 MB
25/12/04 14:49:37 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/04 14:49:37 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/04 14:49:37 INFO SparkUI: Started SparkUI at http://49.52.27.65:4040
25/12/04 14:49:37 INFO HttpFileServer: HTTP File server directory is /tmp/spark/work/spark-1f2695e0-3437-406c-93ed-0fa328714a4e/httpd-3afa577f-29ab-49ea-89d8-e7f2bc05c20f
25/12/04 14:49:37 INFO HttpServer: Starting HTTP Server
25/12/04 14:49:37 INFO Utils: Successfully started service 'HTTP file server' on port 39413.
25/12/04 14:49:37 INFO SparkContext: Added JAR file:/home/djk/Documents/shuffle-experiment/target/scala-2.10/spark-shuffle-experiment-1.0.0.jar at http://49.52.27.65:39413/jars/spark-shuffle-experiment-1.0.0.jar with timestamp 1764859777806
25/12/04 14:49:37 INFO AppClient$ClientEndpoint: Connecting to master spark://49.52.27.113:7077...
25/12/04 14:49:48 INFO SparkDeploySchedulerBackend: Connected to Spark cluster with app ID app-20251204094937-0175
25/12/04 14:49:48 INFO AppClient$ClientEndpoint: Executor added: app-20251204094937-0175/0 on worker-20251203224515-49.52.27.60-35123 (49.52.27.60:35123) with 2 cores
25/12/04 14:49:48 INFO SparkDeploySchedulerBackend: Granted executor ID app-20251204094937-0175/0 on hostPort 49.52.27.60:35123 with 2 cores, 8.0 GB RAM
25/12/04 14:49:48 INFO AppClient$ClientEndpoint: Executor added: app-20251204094937-0175/1 on worker-20251203144508-49.52.27.65-34725 (49.52.27.65:34725) with 2 cores
25/12/04 14:49:48 INFO SparkDeploySchedulerBackend: Granted executor ID app-20251204094937-0175/1 on hostPort 49.52.27.65:34725 with 2 cores, 8.0 GB RAM
25/12/04 14:49:48 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 42743.
25/12/04 14:49:48 INFO NettyBlockTransferService: Server created on 42743
25/12/04 14:49:48 INFO BlockManagerMaster: Trying to register BlockManager
25/12/04 14:49:48 INFO BlockManagerMasterEndpoint: Registering block manager 49.52.27.65:42743 with 143.3 MB RAM, BlockManagerId(driver, 49.52.27.65, 42743)
25/12/04 14:49:48 INFO AppClient$ClientEndpoint: Executor updated: app-20251204094937-0175/1 is now RUNNING
25/12/04 14:49:48 INFO BlockManagerMaster: Registered BlockManager
25/12/04 14:49:48 INFO AppClient$ClientEndpoint: Executor updated: app-20251204094937-0175/0 is now RUNNING
25/12/04 14:49:58 INFO EventLoggingListener: Logging events to file:/tmp/spark-events/app-20251204094937-0175
25/12/04 14:49:58 INFO SparkDeploySchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
=== Shuffle File Monitor 实验 ===
3. Spark版本: 1.6.3
默认shuffle分区数: 200
请求的Shuffle Manager: sort
当前 Shuffle Manager: sort
Spark 本地目录: /tmp/spark/work
监控将每秒检查一次 /tmp/spark/work 目录中的 shuffle_* 文件
测试数据集: medium
分区数: 100
>>> 正在进行数据预热 (Cache & Count)...
>>> 预热完成! 数据已驻留内存。耗时: 30129ms, 记录数: 5000000
>>> 现在开始正式 Shuffle 实验 (此时文件应该会立即产生)

=== 开始运行 sort 实验 ===
启动Shuffle文件监控，每秒检查一次...
[ShuffleMonitor 14:50:29] 文件数: 96, 总大小: 1KB (峰值: 96文件, 1KB)
[ShuffleMonitor 14:50:30] 文件数: 96, 总大小: 1KB (峰值: 96文件, 1KB)
[ShuffleMonitor 14:50:31] 文件数: 100, 总大小: 147.92MB (峰值: 100文件, 147.92MB)
[ShuffleMonitor 14:50:32] 文件数: 106, 总大小: 297.92MB (峰值: 106文件, 297.92MB)
[ShuffleMonitor 14:50:33] 文件数: 110, 总大小: 461.30MB (峰值: 110文件, 461.30MB)
[ShuffleMonitor 14:50:34] 文件数: 114, 总大小: 597.02MB (峰值: 114文件, 597.02MB)
[ShuffleMonitor 14:50:35] 文件数: 118, 总大小: 790.18MB (峰值: 118文件, 790.18MB)
[ShuffleMonitor 14:50:36] 文件数: 122, 总大小: 951.64MB (峰值: 122文件, 951.64MB)
[ShuffleMonitor 14:50:37] 文件数: 126, 总大小: 1.12GB (峰值: 126文件, 1.12GB)
[ShuffleMonitor 14:50:38] 文件数: 130, 总大小: 1.29GB (峰值: 130文件, 1.29GB)
[ShuffleMonitor 14:50:39] 文件数: 136, 总大小: 1.45GB (峰值: 136文件, 1.45GB)
[ShuffleMonitor 14:50:40] 文件数: 140, 总大小: 1.59GB (峰值: 140文件, 1.59GB)
[ShuffleMonitor 14:50:41] 文件数: 144, 总大小: 1.74GB (峰值: 144文件, 1.74GB)
[ShuffleMonitor 14:50:42] 文件数: 148, 总大小: 1.88GB (峰值: 148文件, 1.88GB)
[ShuffleMonitor 14:50:43] 文件数: 152, 总大小: 2.02GB (峰值: 152文件, 2.02GB)
[ShuffleMonitor 14:50:44] 文件数: 156, 总大小: 2.17GB (峰值: 156文件, 2.17GB)
[ShuffleMonitor 14:50:45] 文件数: 162, 总大小: 2.33GB (峰值: 162文件, 2.33GB)
[ShuffleMonitor 14:50:46] 文件数: 166, 总大小: 2.52GB (峰值: 166文件, 2.52GB)
[ShuffleMonitor 14:50:47] 文件数: 170, 总大小: 2.67GB (峰值: 170文件, 2.67GB)
[ShuffleMonitor 14:50:48] 文件数: 175, 总大小: 2.87GB (峰值: 175文件, 2.87GB)
[ShuffleMonitor 14:50:49] 文件数: 179, 总大小: 3.02GB (峰值: 179文件, 3.02GB)
[ShuffleMonitor 14:50:50] 文件数: 184, 总大小: 3.18GB (峰值: 184文件, 3.18GB)
[ShuffleMonitor 14:50:51] 文件数: 188, 总大小: 3.32GB (峰值: 188文件, 3.32GB)
[ShuffleMonitor 14:50:52] 文件数: 192, 总大小: 3.47GB (峰值: 192文件, 3.47GB)
[ShuffleMonitor 14:50:53] 文件数: 196, 总大小: 3.61GB (峰值: 196文件, 3.61GB)
[ShuffleMonitor 14:50:54] 文件数: 201, 总大小: 3.78GB (峰值: 201文件, 3.78GB)
[ShuffleMonitor 14:50:55] 文件数: 206, 总大小: 3.95GB (峰值: 206文件, 3.95GB)
[ShuffleMonitor 14:50:56] 文件数: 210, 总大小: 4.15GB (峰值: 210文件, 4.15GB)
[ShuffleMonitor 14:50:57] 文件数: 215, 总大小: 4.32GB (峰值: 215文件, 4.32GB)
[ShuffleMonitor 14:50:58] 文件数: 219, 总大小: 4.48GB (峰值: 219文件, 4.48GB)
[ShuffleMonitor 14:50:59] 文件数: 224, 总大小: 4.63GB (峰值: 224文件, 4.63GB)
[ShuffleMonitor 14:51:00] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:01] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:02] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:03] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:04] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:05] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:06] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:07] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:08] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:09] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:10] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:11] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:12] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:13] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:14] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:15] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:16] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:17] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:18] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:19] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:20] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:21] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:22] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:23] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:24] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:25] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:26] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:27] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:28] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:29] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:30] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:31] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:32] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:33] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:34] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:35] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:36] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:37] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:38] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:39] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:40] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:41] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:42] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:43] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:44] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:45] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)
[ShuffleMonitor 14:51:46] 文件数: 226, 总大小: 4.70GB (峰值: 226文件, 4.70GB)

[ShuffleMonitor 最终报告]
峰值文件数: 226
峰值文件大小: 4.70GB
推测Shuffle类型: Sort Shuffle

==================================================
测试结果 [sort]:
  执行耗时: 73264ms
  Shuffle数据量: 7.23 GB
  峰值Shuffle文件数: 226 个
  峰值Shuffle文件大小: 4927148KB (4811.67MB)
  Shuffle类型分析: 混合/不确定 (226 个文件)
  平均每个文件大小: 21801KB
